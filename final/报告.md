# 电路图

## 超前进位加法器

### 进位单元（以4位为例）

![image-20231214160216237](C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231214160216237.png)

## ![image-20231214160811707](C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231214160811707.png)

## 进位选择加法器

### 进位单元

![image-20231214103611065](C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231214103611065.png)





### 逻辑门

#### 与非门

<img src="C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231214103332835.png" alt="image-20231214103332835" style="zoom:50%;" />

#### 或非门

<img src="C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231214103353821.png" alt="image-20231214103353821" style="zoom:50%;" />

#### 反相器

<img src="C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231214103410598.png" alt="image-20231214103410598" style="zoom:50%;" />

#### 异或门

<img src="C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231214103459244.png" alt="image-20231214103459244" style="zoom:50%;" />

### 2路选择器

![image-20231214154801307](C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231214154801307.png)

# 遇到的问题

## 衬底该怎么接？该不该考虑衬偏效应？

### NMOS接地，PMOS接VDD

一般的NMOS drain端都是接高电位，只有衬底为低电位，那么drain端和P阱相当于[PN结](https://zhidao.baidu.com/search?word=PN结&fr=iknow_pc_qb_highlight)反偏，才不会有衬底漏电；同理PMOS的drain为最低点位，为了防止drain端和N阱正偏，所以NMOS衬底接低点位 PMOS接高点位

### 考虑到工艺问题，NMOS无法消除衬偏

P-SUB工艺，NMOS 的衬底都是一样的，都是P-SUB，所以不可以将源极和衬底接一块，不然通过衬底短接会影响其他NMOS的特性，因此NMOS的衬底只能接GND（低电位）；

P-SUB工艺，PMOS管的N衬底都是单独的，因此可以将源极和衬底接一块来减小衬偏效应；

 ![image-20231227171332787](C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231227171332787.png)

因为没有DNWell，所以所有NMOS衬底都一样，必须统一接到GND



# 输入组合

1. **等效类划分：** 将所有可能的输入分为等效类，确保每个等效类都至少包含一个代表性的输入。这有助于覆盖各种情况，而不需要穷尽每个可能的输入组合。
2. **边界值测试：** 对于每个输入变量，测试其边界值。对于8位加法器，考虑最小值、最大值、零值等。
3. **错误注入：** 在设计中注入一些已知的错误，然后编写输入组合以检测这些错误。例如，将某个输入位的值置为1，看是否能正确检测溢出或其他错误。
4. **随机测试：** 使用随机生成的输入组合，以增加测试的多样性。这可能不会穷尽所有可能的情况，但可以帮助发现一些未考虑到的问题。
5. **功能测试：** 确保测试输入组合覆盖了加法器的所有功能，包括进位、溢出等情况。
6. **组合输入：** 尝试将输入变量组合在一起，以产生更多的情况。例如，生成多个具有不同输入组合的测试用例，而不是单独测试每个输入变量。

## 等价类划分和随机测试

对8位加法器而言，输入A和B取值均为0-255，低位进位Ci=0或1

本来应该分为有效等价类和无效等价类，但这里我们做的是无符号加法，不存在什么非法输入。非法输入无法接到我开放的接口上。

加数取值[0:255]，使用python随机生成10个测试样例。各自10个，总的10个，总共30个。



## 边界值测试

8位：

- 0+0，0,1
- 255+255，0,1
- 128+128，0,1
- 0+255，0,1

16位：

- 65535+65535，0,1
- 32768+32768，0,1
- 0+65535，0,1

## 功能测试

### 能否正确产生和传播进位信号

8位：

- A[7:0]=B[7:0]=1, Ci=0
- A[i]+B[i]=1, Ci=1

16位：

- A[15:0]=B[15:0]=1, Ci=0
- A[i]+B[i]=1, Ci=1

## 结构分析

### 超前进位和进位选择分开测试

只是级联，耦合度很低。

### 超前进位

#### 测试能否正常产生进位信号

- A[7:0]=B[7:0]=1，Ci=0

​		结果：

![image-20231227233836877](C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231227233836877.png)

![image-20231227233853697](C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231227233853697.png)

- A[i]+B[i]=1, Ci=1

​		结果：

## 延时分析

进位选择的Mux的选择信号为低位进位，低位进位默认为0，所以Mux默认选择低位进位为0的那一组。要想获得关键路径的延时，得令低位进位为1。

输入组合：

A[i]+B[i]=1,Ci=1

![image-20231228163810149](C:\Users\Winter\AppData\Roaming\Typora\typora-user-images\image-20231228163810149.png)
